$(document).on('turbolinks:load', function() {
  var room_number = $("#messages-table").data("room-number");
  App['room' + room_number] = App.cable.subscriptions.create({channel: "RoomChannel",room: room_number}, {
    connected: function() {},
    disconnected: function() {},
    received: function(data) {

      console.log($("#messages-table").data("user-name"))
      if (data.username == $("#messages-table").data("user-name")){
        $("#messages-table").append(
          '<div class="comments_box col-12  mt-5" style="text-align:right">' + 
            '<span>' + '</span>' + ' ' + 
            '<div class= "comments badge-info float-right">' +
              '<span>' + data.content + 
              '</span>' +
            '</div>'+
          '</div>'
        );
      }else{
        if ($("#messages-table").data("user-type") == "Mother"){
          $("#messages-table").append(
            '<div class="comments_box col-12 mt-5">' + 
              '<img class="message_icon" src="/assets/doctor_icon-bd9762496e7fdd20d6979dbb0822e48692daa7ceab29cc98690038b5e0681710.png" alt="Doctor icon">'+
              '<strong>' + 
                '<span>' + 
                    "Dr." + data.username + 
                '</span>' + 
              '</strong>' + 
              ' ' +
              '<div class="comments badge-light">'+ 
                '<span>' + data.content + 
                '</span>' +
              '</div>'+ 
            '</div>');

        }else{
          $("#messages-table").append(
            '<div class="comments_box col-12 mt-5">' + 
              '<img class="message_icon" src="/assets/family_icon-592ac37f014edba00323b7d0fa74b0dceb94f73e0c3f861f7e69a1942ae82e23.png" alt="Family icon">'+
              '<strong>' + 
                '<span>' + 
                    "Ms." + data.username + 
                '</span>' + 
              '</strong>' + 
              ' ' + 
              '<div class="comments badge-light">'+ 
                '<span>' + data.content + 
                '</span>' +
              '</div>'+ 
            '</div>');
        }
      }
      var objDiv = document.getElementById("messages-table");
      objDiv.scrollTop = objDiv.scrollHeight; 
      message_content.value = ""

    }
  })
});

